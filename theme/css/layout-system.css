/* 
 * ============================================================================
 * COMPREHENSIVE VIEWPORT LAYOUT SYSTEM
 * ============================================================================
 * 
 * A SwiftUI-inspired flexbox layout system for mdBook with glassmorphism design.
 * This creates a modern, Apple-style interface with liquid glass effects.
 * 
 * KEY FEATURES:
 * - Vertical stack layout (navbar → content → bottom bar)
 * - Responsive sidebar with resize capability
 * - Glassmorphic containers with backdrop blur
 * - Pixel-perfect alignment across all elements
 * 
 * STRUCTURE:
 * body-container (100vh)
 * └── app-wrapper (VStack with 8px padding)
 *     ├── menu-bar (56px height, glassmorphic navbar)
 *     └── content-wrapper (HStack)
 *         ├── sidebar (300px default, resizable, glassmorphic)
 *         └── page-wrapper (VStack)
 *             ├── page (glassmorphic container)
 *             │   └── content (scrollable area)
 *             └── bottom-bar (44px height, glassmorphic)
 * 
 * CONFIGURATION VARIABLES:
 * --sidebar-width: 300px (adjustable via resize handle)
 * 
 * ============================================================================
 */

/* 
 * RESET AND BASE SETUP
 * Ensures consistent viewport handling across browsers
 */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: visible;
}

/* 
 * TRANSPARENCY ENFORCEMENT
 * Critical: Forces all containers to be transparent to allow
 * the gradient background to show through
 */
#body-container,
#app-wrapper,
#content-wrapper,
#page-wrapper,
.page {
  background: transparent !important;
  background-color: transparent !important;
}

/* 
 * MAIN PAGE CONTAINER
 * Root container that fills the entire viewport
 * Uses flexbox for vertical stacking of all elements
 */
#body-container {
  height: 100vh;
  width: 100vw;
  display: flex;
  flex-direction: column;
  overflow: visible;
}

/* 
 * APP WRAPPER - PRIMARY LAYOUT CONTAINER
 * Creates the main vertical stack with consistent padding
 * 
 * CONFIGURABLE:
 * - padding: 8px (outer spacing around all elements)
 * - gap: 8px (spacing between navbar and content)
 */
#app-wrapper {
  height: 100%;
  width: 100%;
  display: flex;
  flex-direction: column;
  padding: 8px;
  box-sizing: border-box;
  gap: 8px;
}

/* 
 * NAVBAR - TOP NAVIGATION BAR
 * Fixed-height glassmorphic container for navigation
 * 
 * CONFIGURABLE:
 * - height: 56px (navbar height)
 * - padding: 0 2rem (horizontal padding)
 * - background: rgba(255, 255, 255, 0.05) (glass opacity)
 * - backdrop-filter: blur(12px) (blur intensity)
 * - border-radius: 12px (corner roundness)
 */
#app-wrapper > .menu-bar {
  height: 56px;
  min-height: 56px;
  flex: 0 0 56px;
  width: 100%;
  margin: 0;
  
  /* Liquid glass effect */
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.25);
  
  /* Flexbox layout for navbar content */
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 3rem 0 2rem;
}

/* 
 * CONTENT WRAPPER - HORIZONTAL LAYOUT
 * Creates the two-column layout for sidebar and main content
 * Uses flexbox for responsive behavior
 */
#content-wrapper {
  flex: 1;
  display: flex;
  gap: 8px;
  min-height: 0; /* Important for flex children */
  padding: 4px;
}

/* 
 * SIDEBAR - TABLE OF CONTENTS
 * Resizable glassmorphic sidebar with scroll capability
 * 
 * CONFIGURABLE:
 * - width: var(--sidebar-width, 300px) (default width)
 * - min-width: 200px (minimum resize limit)
 * - max-width: 500px (maximum resize limit)
 * - background: rgba(255, 255, 255, 0.05) (glass opacity)
 */
#sidebar {
  width: var(--sidebar-width, 300px);
  min-width: 200px;
  max-width: 500px;
  flex: 0 0 var(--sidebar-width, 300px);
  
  /* Liquid glass effect */
  background: transparent;
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
  
  /* Flexbox for sidebar content */
  display: flex;
  flex-direction: column;
}

#sidebar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  z-index: -1;
}

#sidebar .sidebar-scrollbox {
  flex: 1;
  overflow-y: scroll; /* Always show scrollbar */
  overflow-x: hidden;
  padding: 1rem;
  background: transparent;
  position: relative;
  z-index: 1;
}

/* 
 * PAGE WRAPPER - CONTENT CONTAINER
 * Vertical stack containing main content and bottom navigation
 * IMPORTANT: padding-top: 12px ensures proper spacing after navbar
 */
#page-wrapper {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-width: 0;
  padding-top: 12px;
  box-sizing: border-box;
}

/* 
 * PAGE - GLASSMORPHIC CONTENT CONTAINER
 * The main glassmorphic container that holds scrollable content
 * 
 * CONFIGURABLE:
 * - padding: 1rem (inner content padding)
 * - background: rgba(255, 255, 255, 0.02) (glass opacity)
 * - backdrop-filter: blur(8px) (blur intensity)
 * - border-radius: 12px (corner roundness)
 * 
 * NOTE: overflow: hidden is critical for border-radius clipping
 */
.page {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  
  /* Apply glassmorphism to non-scrolling container */
  background: rgba(255, 255, 255, 0.02) !important;
  backdrop-filter: blur(8px) !important;
  -webkit-backdrop-filter: blur(8px) !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  border-radius: 12px !important;
  box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.25) !important;
  /* Force proper rendering */
  transform: translateZ(0);
  will-change: transform;
  overflow: hidden;
  /* Add padding to ensure content clears the border-radius */
  padding: 1rem;
  box-sizing: border-box;
}

/* 
 * CONTENT - SCROLLABLE AREA
 * Inner scrollable container for actual page content
 * No glassmorphism here - applied to parent .page instead
 */
#content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  
  /* Remove glassmorphism from scrollable container */
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  padding: 0; /* Padding is now handled by .page container */
  box-sizing: border-box;
}

/* 
 * CONTENT MAIN - ACTUAL PAGE CONTENT
 * The main element containing mdBook content
 * 
 * CONFIGURABLE:
 * - padding: 2rem 3rem (content padding)
 */
#content main {
  background: transparent !important;
  background-color: transparent !important;
  padding: 2rem 3rem;
}

/* 
 * BOTTOM BAR - NAVIGATION FOOTER
 * Fixed-height glassmorphic container for prev/next navigation
 * 
 * CONFIGURABLE:
 * - height: 44px (bar height)
 * - padding: 0 1rem (horizontal padding)
 * - background: rgba(255, 255, 255, 0.05) (glass opacity)
 */
#bottom-bar {
  height: 44px;
  min-height: 44px;
  flex: 0 0 44px;
  
  /* Transparent liquid glass effect - force override */
  background: rgba(255, 255, 255, 0.05) !important;
  background-color: transparent !important;
  backdrop-filter: blur(12px) !important;
  -webkit-backdrop-filter: blur(12px) !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  border-radius: 12px !important;
  box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.25) !important;
  
  /* Flexbox for bottom bar content */
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 1rem;
}

/* 
 * RESPONSIVE BEHAVIOR
 * Mobile-specific adjustments for screens < 1080px
 */
@media (max-width: 1080px) {
  #app-wrapper {
    padding: 4px;
    gap: 4px;
  }
  
  #content-wrapper {
    gap: 4px;
  }
  
  #page-wrapper {
    gap: 4px;
  }
  
  #sidebar {
    position: absolute;
    z-index: 100;
    height: calc(100% - 8px);
    transition: transform 0.3s ease;
  }
  
  .sidebar-hidden #sidebar {
    transform: translateX(-100%);
  }
}

/* 
 * SIDEBAR RESIZE HANDLE
 * Interactive handle for adjusting sidebar width
 * Stores width in CSS variable: --sidebar-width
 */
#sidebar-resize-handle {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 8px;
  cursor: col-resize;
  background: transparent;
  transition: background 0.2s;
  z-index: 10;
}

#sidebar-resize-handle:hover,
#sidebar-resize-handle:active {
  background: rgba(255, 255, 255, 0.1);
}